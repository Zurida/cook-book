{"version":3,"file":"create-DLQ7mHbG.js","sources":["../../../../composables/useClickOutside.ts","../../../../components/common/VSelect.vue","../../../../components/common/VInput.vue","../../../../pages/create.vue"],"sourcesContent":["export const useClickOutside = (\r\n  component: Ref,\r\n  callback: Function,\r\n  excludeComponent: Ref\r\n) => {\r\n\r\n  // fail early if any of the required params is missing\r\n  if (!component) {\r\n    throw new Error('A target component has to be provided.')\r\n  }\r\n\r\n  if (!callback) {\r\n    throw new Error('A callback has to be provided.')\r\n  }\r\n\r\n\r\n\r\n  const listener = (event: Event) => {\r\n    if (\r\n      event.target === component.value ||\r\n      event.composedPath().includes(component.value) ||\r\n      event.target === excludeComponent.value ||\r\n      event.composedPath().includes(excludeComponent.value)\r\n    ) {\r\n      return\r\n    }\r\n    if (typeof callback === 'function') {\r\n      callback()\r\n    }\r\n  }\r\n\r\n  onMounted(() => {\r\n    window.addEventListener('click', listener)\r\n  })\r\n\r\n  onBeforeUnmount(() => {\r\n    window.removeEventListener('click', listener)\r\n  })\r\n}\r\n","<script setup lang=\"ts\">\r\nimport { useClickOutside } from '@/composables/useClickOutside'\r\nimport type { TOption } from '~/types/options';\r\n\r\nconst props = defineProps<{\r\n    options: TOption[] | null,\r\n}>()\r\n\r\nconst model = defineModel()\r\n\r\nconst componentRef = ref()\r\nconst excludeRef = ref()\r\nconst isActive = ref(false)\r\n\r\nconst selectedOption = ref()\r\n\r\nfunction handleClick(option: TOption) {\r\n    selectedOption.value = option.text\r\n    isActive.value = false\r\n}\r\n\r\nuseClickOutside(\r\n    componentRef,\r\n    () => {\r\n        isActive.value = false\r\n    },\r\n    excludeRef\r\n)\r\n\r\n</script>\r\n\r\n<template>\r\n    <div class=\"VSelect\" :class=\"{ active: isActive }\">\r\n        <button type=\"button\" ref=\"excludeRef\" class=\"select-button\" role=\"combobox\" aria-label=\"select button\"\r\n            aria-haspopup=\"listbox\" :aria-expanded=\"isActive\" aria-controls=\"select-dropdown\"\r\n            @click=\"isActive = !isActive\">\r\n            <span class=\"selected-value\">{{ selectedOption || 'Выбрать' }}</span>\r\n            <i class=\"arrow right\"></i>\r\n        </button>\r\n\r\n        <ul class=\"select-dropdown\" role=\"listbox\" id=\"select-dropdown\" ref=\"componentRef\" v-if=\"options\">\r\n            <li role=\"option\" v-for=\"(option, index) in options\" @click=\"handleClick(option)\">\r\n                <input type=\"radio\" :id=\"`option-${option.value}-${index}`\" :value=\"option.value\" v-model=\"model\" />\r\n                <label :for=\"`option-${option.value}-${index}`\">{{ option.text }}</label>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"scss\">\r\n.VSelect {\r\n    position: relative;\r\n    max-width: 100%;\r\n    font-size: 1.15rem;\r\n    color: #000;\r\n\r\n    .select-button {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        width: 100%;\r\n        min-height: 3.8rem;\r\n        font-size: inherit;\r\n        background-color: #fff;\r\n        padding: 0.675em 1em;\r\n        border-radius: 0.25rem;\r\n    }\r\n\r\n    .arrow {\r\n        border: solid var(--black);\r\n        border-width: 0 2px 2px 0;\r\n        display: inline-block;\r\n        padding: 3px;\r\n        transform: rotate(45deg);\r\n        transition: transform .4s;\r\n    }\r\n\r\n    &.active {\r\n        .select-dropdown {\r\n            opacity: 1;\r\n            visibility: visible;\r\n            transform: scaleY(1);\r\n        }\r\n\r\n        .arrow {\r\n            transform: rotate(-135deg);\r\n        }\r\n    }\r\n\r\n    .select-dropdown {\r\n        position: absolute;\r\n        z-index: 100;\r\n        list-style: none;\r\n        width: 100%;\r\n        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\r\n        background-color: #fff;\r\n        border-radius: 4px;\r\n        padding: 10px;\r\n        margin-top: 10px;\r\n        max-height: 200px;\r\n        overflow-y: auto;\r\n        transition: 0.5s ease;\r\n        transform: scaleY(0);\r\n        opacity: 0;\r\n        visibility: hidden;\r\n\r\n        &:focus-within {\r\n            box-shadow: 0 10px 25px rgba(94, 108, 233, 0.6);\r\n        }\r\n\r\n        label {\r\n            display: flex;\r\n            gap: 1rem;\r\n            align-items: center;\r\n            width: 100%;\r\n            padding: 8px 10px;\r\n            cursor: pointer;\r\n            transition: background-color .4s;\r\n\r\n            &:hover {\r\n                background-color: #f2f2f2;\r\n            }\r\n        }\r\n\r\n        &::-webkit-scrollbar {\r\n            width: 4px;\r\n        }\r\n\r\n        &::-webkit-scrollbar-track {\r\n            background: #f1f1f1;\r\n            border-radius: 25px;\r\n        }\r\n\r\n        &::-webkit-scrollbar-thumb {\r\n            background: #ccc;\r\n            border-radius: 25px;\r\n        }\r\n\r\n        input:checked~label {\r\n            background-color: #f2f2f2;\r\n        }\r\n\r\n        input:focus~label {\r\n            background-color: #dfdfdf;\r\n        }\r\n\r\n        input[type=\"radio\"] {\r\n            position: absolute;\r\n            left: 0;\r\n            opacity: 0;\r\n        }\r\n    }\r\n}\r\n</style>","<script setup lang=\"ts\">\r\nconst model = defineModel<string | number>('model')\r\n\r\nconst props = defineProps<{\r\n    type: string\r\n}>()\r\n\r\n\r\nconst isError = ref(false)\r\nfunction validate() {\r\n    if (typeof model.value === 'string') {\r\n        isError.value = model.value.length < 3\r\n    }\r\n\r\n    if (typeof model.value === 'number') {\r\n        isError.value = model.value < 1\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"VInput\">\r\n        <input class=\"VInput__native\" :class=\"{ 'is-error': isError }\" v-model=\"model\" v-bind=\"$attrs\" :type=\"type\"\r\n            @input=\"validate\" />\r\n        <label class=\"VInput__label\" v-if=\"$slots.label\">\r\n            <slot name=\"label\" />\r\n        </label>\r\n        <p v-if=\"isError\" class=\"VInput__error\">Введите {{ type === 'number' ? 'число' : 'не менее 3 символов' }}\r\n        </p>\r\n    </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n.VInput {\r\n    position: relative;\r\n\r\n    &__native {\r\n        width: 100%;\r\n        min-height: 3.8rem;\r\n        padding: 0.675em 1em;\r\n        border-radius: 5px;\r\n        border: none;\r\n        outline: none;\r\n        font-family: inherit;\r\n        -moz-appearance: textfield;\r\n        transition: box-shadow .4s;\r\n\r\n        &::-webkit-outer-spin-button,\r\n        &::-webkit-inner-spin-button {\r\n            -webkit-appearance: none;\r\n            margin: 0;\r\n        }\r\n\r\n\r\n        &:focus~.label,\r\n        &:not(:placeholder-shown)~.label {\r\n            opacity: 0.65;\r\n            transform: scale(0.85) translateY(-0.5rem) translateX(0.15rem);\r\n        }\r\n\r\n        &.has-label {\r\n            padding-top: 2rem;\r\n\r\n            &::placeholder {\r\n                color: transparent;\r\n            }\r\n        }\r\n\r\n        &.is-error {\r\n            box-shadow: 0 0 0 1px red;\r\n        }\r\n    }\r\n\r\n\r\n    &__label {\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        height: 100%;\r\n        // padding: 1rem;\r\n        pointer-events: none;\r\n        transform-origin: 0 0;\r\n        transition: opacity 0.1s ease-in-out, transform 0.1s ease-in-out;\r\n    }\r\n}\r\n</style>","<script setup lang=\"ts\">\r\nimport type { TRecipe } from '~/types/recipe';\r\n\r\ndefinePageMeta({\r\n    layout: 'recipe'\r\n})\r\n\r\nconst { data: measures } = await useFetch('/api/measures')\r\nconst { categories } = useCategoryStore()\r\n\r\n\r\nconst recipe = reactive<TRecipe>({\r\n    category: \"\",\r\n    title: \"\",\r\n    ingridients: [],\r\n    description: \"\",\r\n    images: []\r\n});\r\n\r\nconst isDisabled = ref(true)\r\n\r\nconst ingridient = ref({\r\n    name: \"\",\r\n    quantity: 0,\r\n    measure: null\r\n})\r\n\r\nfunction addIngridient() {\r\n    recipe.ingridients.push({\r\n        ...ingridient.value\r\n    })\r\n    clearIngridientFields()\r\n}\r\n\r\nfunction clearIngridientFields() {\r\n    ingridient.value.name = \"\"\r\n    ingridient.value.quantity = 0\r\n    ingridient.value.measure = null\r\n}\r\n\r\nfunction removeIngridient(index: number) {\r\n    recipe.ingridients.splice(index, 1)\r\n}\r\n\r\nfunction handleChange() {\r\n    if (!ingridient.value.name || !ingridient.value.quantity || !ingridient.value.measure) {\r\n        isDisabled.value = true\r\n    } else {\r\n        isDisabled.value = false\r\n    }\r\n}\r\n\r\nasync function handleSubmit(evt: Event) {\r\n    evt.preventDefault()\r\n\r\n    const body: TRecipe = {\r\n        ...recipe\r\n    }\r\n\r\n    try {\r\n        const response = await $fetch(\"/api/recipe\", {\r\n            method: \"POST\",\r\n            body\r\n        })\r\n        navigateTo('/')\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n}\r\n\r\n</script>\r\n\r\n<template>\r\n    <div class=\"container\">\r\n        <CommonTitle title=\"Добавить рецепт\" class=\"create__title\" />\r\n\r\n        <form class=\"form\" @submit.prevent=\"handleSubmit\">\r\n            <div class=\"form__item\">\r\n                <h3>Категория</h3>\r\n                <CommonVSelect :options=\"categories\" v-model=\"recipe.category\" />\r\n\r\n            </div>\r\n\r\n            <div class=\"form__item\">\r\n                <h3>Заголовок</h3>\r\n                <CommonVInput v-model=\"recipe.title\" type=\"text\" placeholder=\"Введите заголовок\">\r\n                </CommonVInput>\r\n            </div>\r\n\r\n            <div class=\"form__item ingridients\">\r\n                <h3>Инргидиенты</h3>\r\n\r\n                <div class=\"ingridients__list\" v-if=\"recipe.ingridients.length\">\r\n\r\n                    <div class=\"ingridients__item\" v-for=\"(item, index) in recipe.ingridients\"\r\n                        :key=\"`ingridient-${index}`\">\r\n                        <p class=\"ingridients__text\">{{ item.name }} - {{ item.quantity }} {{ item.measure }}</p>\r\n                        <span class=\"ingridients__remove\"><nuxt-icon name=\"close\"\r\n                                @click=\"removeIngridient(index)\"></nuxt-icon></span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"ingridients__fields\" @change=\"handleChange\">\r\n                    <CommonVInput v-model:model=\"ingridient.name\" type=\"text\" placeholder=\"Введите ингридиент\" />\r\n                    <CommonVInput v-model:model=\"ingridient.quantity\" type=\"number\" placeholder=\"Введите количество\" />\r\n                    <CommonVSelect :options=\"measures\" v-model=\"ingridient.measure\" class=\"ingridients__select\" />\r\n                </div>\r\n            </div>\r\n\r\n            <CommonVButton small @click=\"addIngridient\" :disabled=\"isDisabled\">Добавить Инргидиент</CommonVButton>\r\n\r\n            <div class=\"form__item\">\r\n                <h3>Способ приготовления</h3>\r\n                <CommonVTextarea placeholder=\"Введите текст\" id=\"steps\" v-model=\"recipe.description\"></CommonVTextarea>\r\n            </div>\r\n\r\n            <!-- <div class=\"form__item\">\r\n                <span>+</span>\r\n                <p>Добавить фото</p>\r\n            </div> -->\r\n\r\n\r\n            <CommonVButton small type=\"submit\">Сохранить</CommonVButton>\r\n\r\n        </form>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"scss\">\r\n.create {\r\n    &__title {\r\n        margin-top: 2rem;\r\n        margin-bottom: 2rem;\r\n    }\r\n}\r\n\r\n.form {\r\n    &__item {\r\n        margin-bottom: 1rem;\r\n    }\r\n}\r\n\r\nh3 {\r\n    margin-bottom: 1rem;\r\n    font-size: 1.8rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.ingridients {\r\n    width: 100%;\r\n\r\n    &__list {\r\n        font-size: 1.4rem;\r\n        color: var(--main-2);\r\n    }\r\n\r\n    &__item {\r\n        display: flex;\r\n        align-items: center;\r\n        margin-bottom: 1rem;\r\n    }\r\n\r\n    &__text {\r\n        width: 100%;\r\n        padding: .6rem;\r\n        background-color: bisque;\r\n        border-radius: 5px;\r\n    }\r\n\r\n    &__remove {\r\n        margin-left: 1rem;\r\n        margin-right: 1rem;\r\n        transition: scale .4s;\r\n\r\n        svg {\r\n            width: 3rem;\r\n        }\r\n\r\n        &:hover {\r\n            cursor: pointer;\r\n            scale: 1.2;\r\n        }\r\n    }\r\n\r\n    &__fields {\r\n        display: flex;\r\n        gap: .5rem;\r\n        width: 100%;\r\n    }\r\n\r\n    &__select {\r\n        flex: 1;\r\n    }\r\n}\r\n</style>"],"names":["_useModel","_withAsyncContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAO,MAAM,kBAAkB,CAC7B,WACA,UACA,qBACG;AAGH,MAAI,CAAC,WAAW;AACR,UAAA,IAAI,MAAM,wCAAwC;AAAA,EAC1D;AAEA,MAAI,CAAC,UAAU;AACP,UAAA,IAAI,MAAM,gCAAgC;AAAA,EAClD;AAyBF;;;;;;;;;;;;AC9BM,UAAA,QAAQA,8BAAY;AAE1B,UAAM,eAAe;AACF,QAAI;AACjB,UAAA,WAAW,IAAI,KAAK;AAE1B,UAAM,iBAAiB;AAOvB;AAAA,MACI;AAAA,MACA,MAAM;AACF,iBAAS,QAAQ;AAAA,MAAA;AAAA,IAGzB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1BM,UAAA,QAAQA,SAA4B,SAAC,OAAO;AAO5C,UAAA,UAAU,IAAI,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACDzB,UAAM,EAAE,MAAM,cAAmB,CAAA,QAAA,SAAA,IAAAC,iBAAA,MAAA,SAAS,8BAAe,CAAA;AACnD,UAAA,EAAE,eAAe;AAGvB,UAAM,SAAS,SAAkB;AAAA,MAC7B,UAAU;AAAA,MACV,OAAO;AAAA,MACP,aAAa,CAAC;AAAA,MACd,aAAa;AAAA,MACb,QAAQ,CAAC;AAAA,IAAA,CACZ;AAEK,UAAA,aAAa,IAAI,IAAI;AAE3B,UAAM,aAAa,IAAI;AAAA,MACnB,MAAM;AAAA,MACN,UAAU;AAAA,MACV,SAAS;AAAA,IAAA,CACZ;AAED,aAAS,gBAAgB;AACrB,aAAO,YAAY,KAAK;AAAA,QACpB,GAAG,WAAW;AAAA,MAAA,CACjB;AACqB;IAC1B;AAEA,aAAS,wBAAwB;AAC7B,iBAAW,MAAM,OAAO;AACxB,iBAAW,MAAM,WAAW;AAC5B,iBAAW,MAAM,UAAU;AAAA,IAC/B;AAEA,aAAS,iBAAiB,OAAe;AAC9B,aAAA,YAAY,OAAO,OAAO,CAAC;AAAA,IACtC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}